<!DOCTYPE html>
<html lang="en">
<head>
    <title>ðŸš¨ Mini IDS Dashboard</title>
    <meta charset="UTF-8">
    <meta http-equiv="refresh" content="2">
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #0f172a;
            color: #e5e7eb;
            padding: 30px;
        }
        h1 { color: #38bdf8; border-bottom: 2px solid #334155; padding-bottom: 10px; }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }

        th, td {
            padding: 14px;
            border: 1px solid #334155;
            text-align: left;
        }

        th {
            background-color: #1e293b;
            color: #38bdf8;
            text-transform: uppercase;
            font-size: 0.85rem;
        }

        tr:nth-child(even) { background-color: #111827; }

        /* Scans on sensitive ports (SSH, Telnet, RDP) */
        .critical { background-color: #7f1d1d; color: #fecaca; }

        /* General network traffic alerts */
        .info { background-color: #1e293b; color: #94a3b8; }

        /* Direct hits on the Honeypot service */
        .honeypot {
            background-color: #431407;
            color: #fdba74;
            font-weight: bold;
            border-left: 5px solid #ea580c;
        }

        .badge {
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.75rem;
            font-weight: bold;
            background: rgba(0,0,0,0.3);
        }
    </style>
</head>

<body>
    <h1>ðŸš¨ IDS & Honeypot Alerts Dashboard</h1>
    <p>Monitoring suspicious activity on specialized ports and honeypot traps.</p>

    {% if alerts %}
    <table>
        <thead>
            <tr>
                <th>Time</th>
                <th>Source IP</th>
                <th>Destination</th>
                <th>Port</th>
                <th>Type</th>
            </tr>
        </thead>
        <tbody>
        {% for alert in alerts %}
            {# Logic to determine row styling based on alert source and port #}
            {% if alert.type == "HONEYPOT" %}
                {% set css_class = "honeypot" %}
            {% elif alert.port in [22, 23, 3389] %}
                {% set css_class = "critical" %}
            {% else %}
                {% set css_class = "info" %}
            {% endif %}

            <tr class="{{ css_class }}">
                <td>{{ alert.time }}</td>
                <td>{{ alert.src }}</td>
                <td>{{ alert.dst }}</td>
                <td><span class="badge">{{ alert.port }}</span></td>
                <td>{{ alert.type }}</td>
            </tr>
        {% endfor %}
        </tbody>
    </table>
    {% else %}
    <div style="padding: 40px; text-align: center; background: #1e293b; border-radius: 8px;">
        <p>ðŸ“¡ Scanning network... No alerts detected yet.</p>
    </div>
    {% endif %}
</body>
</html>